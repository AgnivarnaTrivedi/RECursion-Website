<% content_for :heading do %>
	askREC
<% end %>

<div class="container-fluid" style="height: 100%">

<p id="notice"><%= notice %></p>
<div class="col s6 m2 l2">
<div class="search_wrapper">
  <input id="search" placeholder="Search for Tags">
  <div class="search_results"></div>
</div>
</div>

<table style="width:100%">
  <tr>
    <th>Title</th>
    <th><%= sortable "Answers" %></th>
    <th><%= sortable "Follows" %></th>
    <th><%= sortable "Upvotes" %></th>

  </tr>
   <% @questions.each do |question| %>
  <tr>
    <td><%= link_to question.title.truncate(75), question_path(question) %></td>
    <td><%= question.answer_count %></td> 
    <td><%= question.follow_count %></td>
    <td><%= question.upvote_count %></td>
  </tr>
  <% end %>
</table>



</div>






<script>
  
$(document).ready(function(){

    $("#search").keyup(function(){
      keyword = $(this).val();

      if( keyword.length < 1 || /^[\s]*$/.test(keyword) == true){
        $('.search_results').html("");
        return;
      }

      $.ajax({
        type: "POST",
        url: "/find_questions",
        data: {"keyword": keyword},
        success: function(result){
          var newHTML = [];
          for (var i = 0; i < result.tags.length; i++) {
            newHTML.push('<h6><a href="/askrec/questions/tags/' + result.tags[i][0] + '">' + result.tags[i][0] + '</a><span class="new badge" data-badge-caption="">' + result.tags[i][1] + '</span></h6><br />');
          }
          $('.search_results').html(newHTML);
        },
      });
    });

});

</script>
